{"version":3,"file":"use-intl.esm7.js","sources":["../../src/core/createBaseTranslator.tsx"],"sourcesContent":["// eslint-disable-next-line import/no-named-as-default -- False positive\nimport IntlMessageFormat from 'intl-messageformat';\nimport {\n  cloneElement,\n  isValidElement,\n  ReactElement,\n  ReactNode,\n  ReactNodeArray\n} from 'react';\nimport AbstractIntlMessages from './AbstractIntlMessages';\nimport Formats from './Formats';\nimport {InitializedIntlConfig} from './IntlConfig';\nimport IntlError, {IntlErrorCode} from './IntlError';\nimport TranslationValues, {RichTranslationValues} from './TranslationValues';\nimport convertFormatsToIntlMessageFormat from './convertFormatsToIntlMessageFormat';\nimport {defaultGetMessageFallback, defaultOnError} from './defaults';\nimport MessageKeys from './utils/MessageKeys';\nimport NestedKeyOf from './utils/NestedKeyOf';\nimport NestedValueOf from './utils/NestedValueOf';\n\nfunction resolvePath(\n  messages: AbstractIntlMessages | undefined,\n  key: string,\n  namespace?: string\n) {\n  if (!messages) {\n    throw new Error(\n      process.env.NODE_ENV !== 'production'\n        ? `No messages available at \\`${namespace}\\`.`\n        : undefined\n    );\n  }\n\n  let message = messages;\n\n  key.split('.').forEach((part) => {\n    const next = (message as any)[part];\n\n    if (part == null || next == null) {\n      throw new Error(\n        process.env.NODE_ENV !== 'production'\n          ? `Could not resolve \\`${key}\\` in ${\n              namespace ? `\\`${namespace}\\`` : 'messages'\n            }.`\n          : undefined\n      );\n    }\n\n    message = next;\n  });\n\n  return message;\n}\n\nfunction prepareTranslationValues(values: RichTranslationValues) {\n  if (Object.keys(values).length === 0) return undefined;\n\n  // Workaround for https://github.com/formatjs/formatjs/issues/1467\n  const transformedValues: RichTranslationValues = {};\n  Object.keys(values).forEach((key) => {\n    let index = 0;\n    const value = values[key];\n\n    let transformed;\n    if (typeof value === 'function') {\n      transformed = (chunks: ReactNode) => {\n        const result = value(chunks);\n\n        return isValidElement(result)\n          ? cloneElement(result, {key: key + index++})\n          : result;\n      };\n    } else {\n      transformed = value;\n    }\n\n    transformedValues[key] = transformed;\n  });\n\n  return transformedValues;\n}\n\nexport function getMessagesOrError<Messages extends AbstractIntlMessages>({\n  messages,\n  namespace,\n  onError = defaultOnError\n}: {\n  messages: Messages;\n  namespace?: string;\n  onError?(error: IntlError): void;\n}) {\n  try {\n    if (!messages) {\n      throw new Error(\n        process.env.NODE_ENV !== 'production'\n          ? `No messages were configured on the provider.`\n          : undefined\n      );\n    }\n\n    const retrievedMessages = namespace\n      ? resolvePath(messages, namespace)\n      : messages;\n\n    if (!retrievedMessages) {\n      throw new Error(\n        process.env.NODE_ENV !== 'production'\n          ? `No messages for namespace \\`${namespace}\\` found.`\n          : undefined\n      );\n    }\n\n    return retrievedMessages;\n  } catch (error) {\n    const intlError = new IntlError(\n      IntlErrorCode.MISSING_MESSAGE,\n      (error as Error).message\n    );\n    onError(intlError);\n    return intlError;\n  }\n}\n\nexport type CreateBaseTranslatorProps<Messages> = InitializedIntlConfig & {\n  cachedFormatsByLocale?: Record<string, Record<string, IntlMessageFormat>>;\n  defaultTranslationValues?: RichTranslationValues;\n  namespace?: string;\n  messagesOrError: Messages | IntlError;\n};\n\nexport default function createBaseTranslator<\n  Messages extends AbstractIntlMessages,\n  NestedKey extends NestedKeyOf<Messages>\n>({\n  cachedFormatsByLocale,\n  defaultTranslationValues,\n  formats: globalFormats,\n  getMessageFallback = defaultGetMessageFallback,\n  locale,\n  messagesOrError,\n  namespace,\n  onError,\n  timeZone\n}: CreateBaseTranslatorProps<Messages>) {\n  function getFallbackFromErrorAndNotify(\n    key: string,\n    code: IntlErrorCode,\n    message?: string\n  ) {\n    const error = new IntlError(code, message);\n    onError(error);\n    return getMessageFallback({error, key, namespace});\n  }\n\n  function translateBaseFn(\n    /** Use a dot to indicate a level of nesting (e.g. `namespace.nestedLabel`). */\n    key: string,\n    /** Key value pairs for values to interpolate into the message. */\n    values?: RichTranslationValues,\n    /** Provide custom formats for numbers, dates and times. */\n    formats?: Partial<Formats>\n  ): string | ReactElement | ReactNodeArray {\n    if (messagesOrError instanceof IntlError) {\n      // We have already warned about this during render\n      return getMessageFallback({\n        error: messagesOrError,\n        key,\n        namespace\n      });\n    }\n    const messages = messagesOrError;\n\n    let message;\n    try {\n      message = resolvePath(messages, key, namespace);\n    } catch (error) {\n      return getFallbackFromErrorAndNotify(\n        key,\n        IntlErrorCode.MISSING_MESSAGE,\n        (error as Error).message\n      );\n    }\n\n    function joinPath(parts: Array<string | undefined>) {\n      return parts.filter((part) => part != null).join('.');\n    }\n\n    const cacheKey = joinPath([namespace, key, String(message)]);\n\n    let messageFormat;\n    if (cachedFormatsByLocale?.[locale]?.[cacheKey]) {\n      messageFormat = cachedFormatsByLocale?.[locale][cacheKey];\n    } else {\n      if (typeof message === 'object') {\n        let code, errorMessage;\n        if (Array.isArray(message)) {\n          code = IntlErrorCode.INVALID_MESSAGE;\n          if (process.env.NODE_ENV !== 'production') {\n            errorMessage = `Message at \\`${joinPath([\n              namespace,\n              key\n            ])}\\` resolved to an array, but only strings are supported. See https://next-intl-docs.vercel.app/docs/usage/messages#arrays-of-messages`;\n          }\n        } else {\n          code = IntlErrorCode.INSUFFICIENT_PATH;\n          if (process.env.NODE_ENV !== 'production') {\n            errorMessage = `Message at \\`${joinPath([\n              namespace,\n              key\n            ])}\\` resolved to an object, but only strings are supported. Use a \\`.\\` to retrieve nested messages. See https://next-intl-docs.vercel.app/docs/usage/messages#structuring-messages`;\n          }\n        }\n\n        return getFallbackFromErrorAndNotify(key, code, errorMessage);\n      }\n\n      try {\n        messageFormat = new IntlMessageFormat(\n          message,\n          locale,\n          convertFormatsToIntlMessageFormat(\n            {...globalFormats, ...formats},\n            timeZone\n          )\n        );\n      } catch (error) {\n        return getFallbackFromErrorAndNotify(\n          key,\n          IntlErrorCode.INVALID_MESSAGE,\n          (error as Error).message\n        );\n      }\n\n      if (cachedFormatsByLocale) {\n        if (!cachedFormatsByLocale[locale]) {\n          cachedFormatsByLocale[locale] = {};\n        }\n        cachedFormatsByLocale[locale][cacheKey] = messageFormat;\n      }\n    }\n\n    try {\n      const formattedMessage = messageFormat.format(\n        // @ts-ignore `intl-messageformat` expects a different format\n        // for rich text elements since a recent minor update. This\n        // needs to be evaluated in detail, possibly also in regards\n        // to be able to format to parts.\n        prepareTranslationValues({...defaultTranslationValues, ...values})\n      );\n\n      if (formattedMessage == null) {\n        throw new Error(\n          process.env.NODE_ENV !== 'production'\n            ? `Unable to format \\`${key}\\` in ${\n                namespace ? `namespace \\`${namespace}\\`` : 'messages'\n              }`\n            : undefined\n        );\n      }\n\n      // Limit the function signature to return strings or React elements\n      return isValidElement(formattedMessage) ||\n        // Arrays of React elements\n        Array.isArray(formattedMessage) ||\n        typeof formattedMessage === 'string'\n        ? formattedMessage\n        : String(formattedMessage);\n    } catch (error) {\n      return getFallbackFromErrorAndNotify(\n        key,\n        IntlErrorCode.FORMATTING_ERROR,\n        (error as Error).message\n      );\n    }\n  }\n\n  function translateFn<\n    TargetKey extends MessageKeys<\n      NestedValueOf<Messages, NestedKey>,\n      NestedKeyOf<NestedValueOf<Messages, NestedKey>>\n    >\n  >(\n    /** Use a dot to indicate a level of nesting (e.g. `namespace.nestedLabel`). */\n    key: TargetKey,\n    /** Key value pairs for values to interpolate into the message. */\n    values?: TranslationValues,\n    /** Provide custom formats for numbers, dates and times. */\n    formats?: Partial<Formats>\n  ): string {\n    const result = translateBaseFn(key, values, formats);\n\n    if (typeof result !== 'string') {\n      return getFallbackFromErrorAndNotify(\n        key,\n        IntlErrorCode.INVALID_MESSAGE,\n        process.env.NODE_ENV !== 'production'\n          ? `The message \\`${key}\\` in ${\n              namespace ? `namespace \\`${namespace}\\`` : 'messages'\n            } didn't resolve to a string. If you want to format rich text, use \\`t.rich\\` instead.`\n          : undefined\n      );\n    }\n\n    return result;\n  }\n\n  translateFn.rich = translateBaseFn;\n\n  translateFn.raw = (\n    /** Use a dot to indicate a level of nesting (e.g. `namespace.nestedLabel`). */\n    key: string\n  ): any => {\n    if (messagesOrError instanceof IntlError) {\n      // We have already warned about this during render\n      return getMessageFallback({\n        error: messagesOrError,\n        key,\n        namespace\n      });\n    }\n    const messages = messagesOrError;\n\n    try {\n      return resolvePath(messages, key, namespace);\n    } catch (error) {\n      return getFallbackFromErrorAndNotify(\n        key,\n        IntlErrorCode.MISSING_MESSAGE,\n        (error as Error).message\n      );\n    }\n  };\n\n  return translateFn;\n}\n"],"names":["resolvePath","messages","key","namespace","Error","process","env","NODE_ENV","undefined","message","split","forEach","part","next","prepareTranslationValues","values","Object","keys","length","transformedValues","index","value","transformed","chunks","result","isValidElement","cloneElement","getMessagesOrError","_ref","_ref$onError","onError","defaultOnError","retrievedMessages","error","intlError","IntlError","IntlErrorCode","MISSING_MESSAGE","createBaseTranslator","_ref2","cachedFormatsByLocale","defaultTranslationValues","globalFormats","formats","_ref2$getMessageFallb","getMessageFallback","defaultGetMessageFallback","locale","messagesOrError","timeZone","getFallbackFromErrorAndNotify","code","translateBaseFn","_cachedFormatsByLocal","joinPath","parts","filter","join","cacheKey","String","messageFormat","errorMessage","Array","isArray","INVALID_MESSAGE","INSUFFICIENT_PATH","IntlMessageFormat","convertFormatsToIntlMessageFormat","_extends","formattedMessage","format","FORMATTING_ERROR","translateFn","rich","raw"],"mappings":"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"}